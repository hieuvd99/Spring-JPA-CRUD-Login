name: CI/CD to Dev Server

on:
  push:
    branches:
      - master

jobs:
  build-and-run:
    runs-on: self-hosted
    name: Build and Run on Dev Server

    steps:
    - name: Checkout code
      uses: actions/checkout@v3

    - name: Show workspace
      run: echo "GITHUB_WORKSPACE is:$GITHUB_WORKSPACE"

    - name: Build project
      run: |
        cd $GITHUB_WORKSPACE
        mvn clean package -DskipTests

    - name: Restart Spring Boot App
      run: sudo systemctl restart myapp
